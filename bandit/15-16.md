## Bandit Level 15 â†’ 16

### Login : ssh bandit15@bandit.labs.overthewire.org -p 2220
### Password : 8xCjnmgoKbGLhHFAZlGE5Tmu4M2tKJQo

### Task

Send the current password for bandit15 to a service listening on `localhost:30001`.
This time, the service requires an SSL/TLS connection. If the password is correct, the server will return the next password.

### Quick theory

`openssl s_client -connect host:port` lets us establish an SSL/TLS connection to a given service.
Adding -quiet suppresses certificate and debug output, making it easier to see just the server response.
We can provide the password directly using input redirection <<< "password" or piping `echo "password" | openssl ....`

```bash
bandit15@bandit:~$ openssl s_client -connect localhost:30001
CONNECTED(00000003)
Can't use SSL_get_servername
depth=0 CN = SnakeOil
verify error:num=18:self-signed certificate
verify return:1
depth=0 CN = SnakeOil
verify return:1
---
Certificate chain
 0 s:CN = SnakeOil
   i:CN = SnakeOil
   a:PKEY: rsaEncryption, 4096 (bit); sigalg: RSA-SHA256
   v:NotBefore: Jun 10 03:59:50 2024 GMT; NotAfter: Jun  8 03:59:50 2034 GMT
---
Server certificate
-----BEGIN CERTIFICATE-----
MIIFBzCCAu+gAwIBAgIUBLz7DBxA0IfojaL/WaJzE6Sbz7cwDQYJKoZIhvcNAQEL
BQAwEzERMA8GA1UEAwwIU25ha2VPaWwwHhcNMjQwNjEwMDM1OTUwWhcNMzQwNjA4
MDM1OTUwWjATMREwDwYDVQQDDAhTbmFrZU9pbDCCAiIwDQYJKoZIhvcNAQEBBQAD
ggIPADCCAgoCggIBANI+P5QXm9Bj21FIPsQqbqZRb5XmSZZJYaam7EIJ16Fxedf+
jXAv4d/FVqiEM4BuSNsNMeBMx2Gq0lAfN33h+RMTjRoMb8yBsZsC063MLfXCk4p+
09gtGP7BS6Iy5XdmfY/fPHvA3JDEScdlDDmd6Lsbdwhv93Q8M6POVO9sv4HuS4t/
jEjr+NhE+Bjr/wDbyg7GL71BP1WPZpQnRE4OzoSrt5+bZVLvODWUFwinB0fLaGRk
GmI0r5EUOUd7HpYyoIQbiNlePGfPpHRKnmdXTTEZEoxeWWAaM1VhPGqfrB/Pnca+
vAJX7iBOb3kHinmfVOScsG/YAUR94wSELeY+UlEWJaELVUntrJ5HeRDiTChiVQ++
wnnjNbepaW6shopybUF3XXfhIb4NvwLWpvoKFXVtcVjlOujF0snVvpE+MRT0wacy
tHtjZs7Ao7GYxDz6H8AdBLKJW67uQon37a4MI260ADFMS+2vEAbNSFP+f6ii5mrB
18cY64ZaF6oU8bjGK7BArDx56bRc3WFyuBIGWAFHEuB948BcshXY7baf5jjzPmgz
mq1zdRthQB31MOM2ii6vuTkheAvKfFf+llH4M9SnES4NSF2hj9NnHga9V08wfhYc
x0W6qu+S8HUdVF+V23yTvUNgz4Q+UoGs4sHSDEsIBFqNvInnpUmtNgcR2L5PAgMB
AAGjUzBRMB0GA1UdDgQWBBTPo8kfze4P9EgxNuyk7+xDGFtAYzAfBgNVHSMEGDAW
gBTPo8kfze4P9EgxNuyk7+xDGFtAYzAPBgNVHRMBAf8EBTADAQH/MA0GCSqGSIb3
DQEBCwUAA4ICAQAKHomtmcGqyiLnhziLe97Mq2+Sul5QgYVwfx/KYOXxv2T8ZmcR
Ae9XFhZT4jsAOUDK1OXx9aZgDGJHJLNEVTe9zWv1ONFfNxEBxQgP7hhmDBWdtj6d
taqEW/Jp06X+08BtnYK9NZsvDg2YRcvOHConeMjwvEL7tQK0m+GVyQfLYg6jnrhx
egH+abucTKxabFcWSE+Vk0uJYMqcbXvB4WNKz9vj4V5Hn7/DN4xIjFko+nREw6Oa
/AUFjNnO/FPjap+d68H1LdzMH3PSs+yjGid+6Zx9FCnt9qZydW13Miqg3nDnODXw
+Z682mQFjVlGPCA5ZOQbyMKY4tNazG2n8qy2famQT3+jF8Lb6a4NGbnpeWnLMkIu
jWLWIkA9MlbdNXuajiPNVyYIK9gdoBzbfaKwoOfSsLxEqlf8rio1GGcEV5Hlz5S2
txwI0xdW9MWeGWoiLbZSbRJH4TIBFFtoBG0LoEJi0C+UPwS8CDngJB4TyrZqEld3
rH87W+Et1t/Nepoc/Eoaux9PFp5VPXP+qwQGmhir/hv7OsgBhrkYuhkjxZ8+1uk7
tUWC/XM0mpLoxsq6vVl3AJaJe1ivdA9xLytsuG4iv02Juc593HXYR8yOpow0Eq2T
U5EyeuFg5RXYwAPi7ykw1PW7zAPL4MlonEVz+QXOSx6eyhimp1VZC11SCg==
-----END CERTIFICATE-----
subject=CN = SnakeOil
issuer=CN = SnakeOil
---
No client certificate CA names sent
Peer signing digest: SHA256
Peer signature type: RSA-PSS
Server Temp Key: X25519, 253 bits
---
SSL handshake has read 2103 bytes and written 373 bytes
Verification error: self-signed certificate
---
New, TLSv1.3, Cipher is TLS_AES_256_GCM_SHA384
Server public key is 4096 bit
Secure Renegotiation IS NOT supported
Compression: NONE
Expansion: NONE
No ALPN negotiated
Early data was not sent
Verify return code: 18 (self-signed certificate)
---
---
Post-Handshake New Session Ticket arrived:
SSL-Session:
    Protocol  : TLSv1.3
    Cipher    : TLS_AES_256_GCM_SHA384
    Session-ID: E5239AA02775863C690DE27A9353790D7C9E918D792F188618A9545F9BE03275
    Session-ID-ctx: 
    Resumption PSK: 42099E0E8E34C02BDA9D70EBA266F85A54997A1BF18699F1333ECBBD1534C11AA67958C0C572C2509C35A67FEDD4AB0C
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    TLS session ticket lifetime hint: 300 (seconds)
    TLS session ticket:
    0000 - 94 64 a5 b8 01 8b 5a 6f-ca c2 01 6b fc 31 ad db   .d....Zo...k.1..
    0010 - 59 ac 5b 9b 1c ae 95 50-fa 9d ec eb a6 06 f9 4a   Y.[....P.......J
    0020 - bc 4a 82 b7 97 a6 3f a6-1d 2d 81 3d ae a0 e1 5e   .J....?..-.=...^
    0030 - 84 92 e3 7f f1 6b c0 ab-48 bc bd ec b8 6d 53 74   .....k..H....mSt
    0040 - a2 89 4a f4 f3 3d 86 c3-98 3e 9c b5 73 6b 21 f4   ..J..=...>..sk!.
    0050 - 44 9a 6a 5f 48 f8 ed 68-c7 75 01 ab 95 0e ba ea   D.j_H..h.u......
    0060 - 86 5f f8 2b 35 cb a9 c5-60 a9 1e 0a 79 13 4c 58   ._.+5...`...y.LX
    0070 - bd 3b d8 d9 94 3d 72 85-f0 af be 59 ec cd 9a e0   .;...=r....Y....
    0080 - 94 a6 72 24 a6 d6 95 61-4c 08 a2 66 3c 77 f6 d5   ..r$...aL..f<w..
    0090 - b2 63 4a fa c8 5f dc 7c-5a e5 7b 98 b4 a5 29 71   .cJ.._.|Z.{...)q
    00a0 - 45 84 fa 97 78 6a 90 df-eb 2c 35 d9 d4 2c e8 04   E...xj...,5..,..
    00b0 - e3 72 a5 ce 8e b9 cb f6-77 a2 a5 e0 9f fa 45 c5   .r......w.....E.
    00c0 - 69 70 0d 60 8e 00 7a 8d-b8 6c 4d b3 ae 6e ae c5   ip.`..z..lM..n..
    00d0 - 72 37 74 24 7c 6a 72 a7-8e 69 47 3f c4 c1 3c 4d   r7t$|jr..iG?..<M

    Start Time: 1758480494
    Timeout   : 7200 (sec)
    Verify return code: 18 (self-signed certificate)
    Extended master secret: no
    Max Early Data: 0
---
read R BLOCK
---
Post-Handshake New Session Ticket arrived:
SSL-Session:
    Protocol  : TLSv1.3
    Cipher    : TLS_AES_256_GCM_SHA384
    Session-ID: FFCB3DAB58AB97545682B8D32EEDD7A33FD1E889A6C55A9A2EC671173CF7F797
    Session-ID-ctx: 
    Resumption PSK: 46538C7ED3B973D5D84ED4894E0AFCFA4613580D549C86BE05458BD60228A70B7381A89940B8BB9109C3925B4EFB7E1B
    PSK identity: None
    PSK identity hint: None
    SRP username: None
    TLS session ticket lifetime hint: 300 (seconds)
    TLS session ticket:
    0000 - 94 64 a5 b8 01 8b 5a 6f-ca c2 01 6b fc 31 ad db   .d....Zo...k.1..
    0010 - be 85 3b a0 70 b3 01 8f-f1 0e cf 01 09 03 72 a2   ..;.p.........r.
    0020 - ee 04 cf d9 91 38 52 c0-3b 98 9d 81 c8 85 dd fe   .....8R.;.......
    0030 - b3 c7 a3 68 bc 29 50 a2-5b f5 c1 66 9f 94 49 79   ...h.)P.[..f..Iy
    0040 - 5c 22 03 70 74 db db 5a-33 ab ec af 09 a3 95 fc   \".pt..Z3.......
    0050 - 6c e0 be 40 1d 63 7f ed-78 be b6 42 dc 78 81 1e   l..@.c..x..B.x..
    0060 - 8e eb 40 a2 f9 24 64 d7-4b 00 e1 c6 e1 9c 2e bf   ..@..$d.K.......
    0070 - e4 0c 3c cd 5c 08 c5 6c-46 b3 38 4f 96 73 91 43   ..<.\..lF.8O.s.C
    0080 - a8 8c 3b c0 de 67 9c 2c-ec ba 26 f9 93 3a 96 77   ..;..g.,..&..:.w
    0090 - ef c2 5a ad c4 72 49 df-df 9e c3 0c e3 37 4d be   ..Z..rI......7M.
    00a0 - da ca 37 52 a3 31 de 11-f2 74 ed f5 22 c5 d3 cc   ..7R.1...t.."...
    00b0 - e7 ab 34 43 a0 30 19 24-82 96 40 a5 98 4f 45 49   ..4C.0.$..@..OEI
    00c0 - be 8f 2f 58 c1 79 16 e4-83 80 13 5f a8 cc 84 ec   ../X.y....._....
    00d0 - 48 8c ca 79 69 82 e5 0f-43 0a c8 8f d1 ff 07 76   H..yi...C......v

    Start Time: 1758480494
    Timeout   : 7200 (sec)
    Verify return code: 18 (self-signed certificate)
    Extended master secret: no
    Max Early Data: 0
---
read R BLOCK
8xCjnmgoKbGLhHFAZlGE5Tmu4M2tKJQo
Correct!
kSkvUpMQ7lBYyCM4GBPvCvT1BfWRy0Dx

closed
```

another one if you dont want long messages and stuff.  

```bash
bandit15@bandit:~$ openssl s_client -connect localhost:30001 -quiet <<< "8xCjnmgoKbGLhHFAZlGE5Tmu4M2tKJQo"
Can't use SSL_get_servername
depth=0 CN = SnakeOil
verify error:num=18:self-signed certificate
verify return:1
depth=0 CN = SnakeOil
verify return:1
Correct!
kSkvUpMQ7lBYyCM4GBPvCvT1BfWRy0Dx
```